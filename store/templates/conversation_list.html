{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>Conversations</h2>
    {% for conversation in conversations %}
    <div class="list-group-item list-group-item-action flex-column align-items-start mb-3 bg-secondary text-white border-dark shadow">
      <div class="d-flex w-100 justify-content-between">
        <h5 class="mb-1 text-white">
          {% if conversation.messages.first.customer %}
            {{ conversation.messages.first.customer.first_name }} {{ conversation.messages.first.customer.last_name }}
          {% else %}
            Customer not found
          {% endif %}
        </h5>
      </div>
      <div class="mt-2">
        <a href="{% url 'customer_edit' conversation.messages.first.customer.id %}" class="btn btn-sm btn-outline-warning mr-2">
          <i class="fas fa-edit"></i> Edit
        </a>
        <a href="{% url 'cart_create' conversation.messages.first.customer.id %}" class="btn btn-sm btn-outline-info">
          <i class="fas fa-shopping-cart"></i> Create Cart
        </a>
        <a href="{% url 'customer_messages' conversation.messages.first.customer.id %}" class="btn btn-sm btn-outline-light">
          <i class="fas fa-envelope"></i> View Messages
        </a>
      </div>
    </div>
  {% empty %}
    <div class="list-group-item bg-secondary text-white border-dark">
      <p class="mb-0 text-light">No conversations available.</p>
    </div>
  {% endfor %}
  
</div>

<!-- Include Font Awesome -->
<script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>

<!-- Custom JavaScript for toggling button text and icon -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleButtons = document.querySelectorAll('.toggle-messages');

    toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
            const buttonText = button.querySelector('.button-text');
            const icon = button.querySelector('i');

            if (buttonText.textContent === 'Show') {
                buttonText.textContent = 'Hide';
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                buttonText.textContent = 'Show';
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        });
    });
});
</script>
{% endblock %}
