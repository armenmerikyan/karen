{% extends 'base.html' %}
{% block content %}
<section class="py-0">
  <div class="container-fluid">
    <div class="container mt-5 text-light">         
      <div class="row">
        <div class="col-md-12 text-left">   
            <h1>Select Payment Type</h1>
            {% if error %}
                <p style="color: red;">{{ error }}</p>
            {% endif %}
            <form method="post" action="{% url 'select_payment' %}">
                {% csrf_token %}

                <label>
                    <input type="radio" name="payment_type" value="solana" required onchange="toggleTokenSelection()"> Solana
                </label>
                <br>
                <label>
                    <input type="radio" name="payment_type" value="solana_token" required onchange="toggleTokenSelection()"> Solana with Token
                </label>
                <br>
                <label>
                    <input type="radio" name="payment_type" value="stripe" required onchange="toggleTokenSelection()"> Stripe
                </label>
                <br>

                <!-- Token Selection (Only for Solana with Token) -->
                <label for="token_address">Select a Token:</label>
                <select name="token_address" id="token_address" disabled required>
                    <option value="">-- Select Token --</option>
                    {% for token in tokens %}
                        <option value="{{ token.address }}">{{ token.name }}</option>
                    {% endfor %}
                </select>
                <br>

                <button type="submit">Continue</button>
            </form>
        </div>
      </div>      
    </div>
  </div>
</section>    

<script>
    function toggleTokenSelection() {
        let solanaTokenOption = document.querySelector('input[value="solana_token"]');
        let tokenDropdown = document.getElementById("token_address");

        if (solanaTokenOption.checked) {
            tokenDropdown.removeAttribute("disabled");
        } else {
            tokenDropdown.setAttribute("disabled", "true");
            tokenDropdown.value = "";
        }
    }
</script>
{% endblock %}
